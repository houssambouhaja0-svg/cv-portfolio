<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDYL | L'Or Liquide Réinventé</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="noise"></div>
    <div id="toast-container"></div>

    <!-- Navigation -->
    <nav id="main-nav"
        class="fixed top-0 w-full z-[100] flex justify-between items-center px-10 py-8 transition-all duration-500 text-primary">
        <div class="flex items-center gap-12 text-[10px] uppercase tracking-[4px] font-bold">
            <a href="#home" class="nav-link">La Maison</a>
            <a href="#engagement" class="nav-link">Engagement</a>
            <a href="#collection" class="nav-link">Collection</a>
            <a href="#testimonials" class="nav-link">Avis</a>
        </div>
        <a href="#home" class="text-3xl tracking-[10px] serif font-bold uppercase cursor-pointer">IDYL</a>
        <div class="flex items-center gap-12 text-[10px] uppercase tracking-[4px] font-bold">
            <a href="#concierge" class="nav-link">Conciergerie</a>
            <a href="#contact" class="nav-link">Contact</a>

            <!-- Theme Toggle -->
            <button onclick="toggleTheme()" class="relative group" title="Changer de mode">
                <svg id="theme-icon-sun" class="w-5 h-5 gold-text transition-transform group-hover:scale-110 hidden"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
                <svg id="theme-icon-moon" class="w-5 h-5 gold-text transition-transform group-hover:scale-110"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </button>

            <!-- Cart Icon -->
            <button id="cart-btn-nav" onclick="toggleCart()" class="relative group">
                <svg class="w-5 h-5 gold-text transition-transform group-hover:scale-110" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4H6z"></path>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <path d="M16 10a4 4 0 0 1-8 0"></path>
                </svg>
                <span id="cart-count"
                    class="absolute -top-2 -right-2 bg-gold text-white text-[8px] w-4 h-4 rounded-full flex items-center justify-center opacity-0 transition-opacity">0</span>
            </button>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu" id="mobile-menu">
        <button class="menu-close-btn" onclick="toggleMenu()">
            <span class="text-[10px] uppercase tracking-[4px] gold-text">Retour</span>
        </button>
        <a href="#home" class="serif text-3xl italic" onclick="toggleMenu()">La Maison</a>
        <a href="#engagement" class="serif text-3xl italic" onclick="toggleMenu()">Engagement</a>
        <a href="#collection" class="serif text-3xl italic" onclick="toggleMenu()">Collection</a>
        <a href="#testimonials" class="serif text-3xl italic" onclick="toggleMenu()">Avis</a>
        <a href="#concierge" class="serif text-3xl italic" onclick="toggleMenu()">Conciergerie</a>
        <a href="#contact" class="serif text-3xl italic" onclick="toggleMenu()">Contact</a>
    </div>

    <!-- Hero Section -->
    <section id="home" class="hero-video-container flex items-center justify-center">
        <!-- Video Background -->
        <div class="absolute inset-0 bg-accent overflow-hidden">
            <video autoplay muted loop playsinline class="absolute inset-0 w-full h-full object-cover opacity-60">
                <source src="video2.mp4" type="video/mp4">
                <!-- Fallback image if video doesn't load -->
                <img src="https://images.unsplash.com/photo-1509042239860-f550ce710b93?auto=format&fit=crop&q=80&w=2000"
                    alt="Background" class="w-full h-full object-cover">
            </video>
        </div>
        <div class="overlay"></div>

        <div class="relative z-10 text-center px-4">
            <p class="uppercase tracking-[6px] text-xs mb-6 fade-in font-light">Heritage of the Souss Valley</p>
            <h1 class="serif text-5xl md:text-8xl mb-8 fade-in italic" style="transition-delay: 0.2s;">
                Min aslet l’bled, l’werth dial jdade
            </h1>
            <div class="flex flex-col items-center">
                <p class="serif text-xl md:text-2xl font-light mb-12 max-w-2xl fade-in text-muted-gold"
                    style="transition-delay: 0.4s;">
                    IDYL, Reinventing Liquid Gold.
                </p>
                <div class="fade-in" style="transition-delay: 0.6s;">
                    <a href="#collection" class="btn-luxury">Explorer la collection</a>
                </div>
            </div>
        </div>

        <div class="absolute bottom-10 left-1/2 -translate-x-1/2 flex flex-col items-center gap-4">
            <div class="w-[1px] h-16 bg-neutral-700 relative overflow-hidden">
                <div
                    class="absolute top-0 left-0 w-full h-full bg-gold translate-y-[-100%] animate-[scrollLine_3s_infinite]">
                </div>
            </div>
        </div>
    </section>



    <!-- Heritage Section -->
    <section
        class="py-32 px-10 md:px-20 grid grid-cols-1 md:grid-cols-2 gap-20 items-center bg-base relative overflow-hidden">
        <!-- Heritage Particle Canvas -->
        <canvas id="heritage-particle-canvas" class="absolute inset-0 pointer-events-none"></canvas>

        <div class="relative h-[500px] flex items-center justify-center fade-in" id="tilt-container"
            style="perspective: 2000px; z-index: 10;">
            <div id="tilt-element" class="relative transition-transform duration-100 ease-out"
                style="transform-style: preserve-3d;">
                <!-- Decorative Glow -->
                <div class="absolute -inset-20 bg-gold/5 blur-[120px] rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-1000"
                    id="heritage-glow"></div>

                <img src="image.07-removebg-preview.png" alt="L'Arbre de Vie"
                    class="w-full max-w-2xl object-contain drop-shadow-[0_20px_50px_rgba(197,160,89,0.2)]"
                    style="transform: translateZ(50px);">

                <!-- Parallax Sparkles -->
                <div class="absolute top-0 left-0 w-full h-full pointer-events-none"
                    style="transform: translateZ(100px);">
                    <div class="absolute top-1/4 left-1/4 w-2 h-2 bg-gold rounded-full blur-[2px] animate-pulse"></div>
                    <div class="absolute top-3/4 left-2/3 w-1.5 h-1.5 bg-gold rounded-full blur-[1px] animate-pulse"
                        style="animation-delay: 1s;"></div>
                    <div class="absolute top-1/2 left-3/4 w-1 h-1 bg-gold rounded-full blur-[1px] animate-pulse"
                        style="animation-delay: 0.5s;"></div>
                </div>
            </div>
        </div>
        <div class="fade-in">
            <p class="uppercase tracking-[6px] text-xs mb-6 font-light text-neutral-500">[Section 1 : L'Héritage]</p>
            <h2 class="serif text-4xl mb-8 leading-tight">L’Arbre de Vie,<br><span class="italic gold-text">La Source de
                    Lumière</span></h2>

            <div class="space-y-8">
                <div>
                    <h3 class="serif text-2xl gold-text italic mb-3">Le Geste Ancestral</h3>
                    <p class="text-secondary leading-relaxed font-light text-lg">
                        Au pied de l'Atlas, l'arganier ne donne pas seulement un fruit, il offre un destin.
                        Chaque noix est sélectionnée avec la même rigueur que les pierres précieuses.
                    </p>
                </div>

                <div class="pl-4 border-l border-neutral-800">
                    <h4 class="text-primary uppercase tracking-widest text-xs mb-2 font-bold">L'Extraction Lente</h4>
                    <p class="text-neutral-500 leading-relaxed font-light">
                        Nos artisanes pressent les noyaux à la main, un geste millénaire qui protège 100% des actifs.
                    </p>
                </div>

                <div class="pl-4 border-l border-neutral-800">
                    <h4 class="text-primary uppercase tracking-widest text-xs mb-2 font-bold">L'Or Vivant</h4>
                    <p class="text-neutral-500 leading-relaxed font-light">
                        Ce procédé "Handmade" garantit une intégrité moléculaire que nulle machine ne peut reproduire.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Narrative Engagement Story -->
    <section id="engagement" class="py-32 bg-base overflow-hidden border-t border-neutral-900/10">
        <div class="max-w-4xl mx-auto px-10">
            <div class="text-center mb-16 fade-in">
                <p class="uppercase tracking-[6px] text-[10px] mb-4 text-neutral-500">Notre Engagement</p>
                <h2 class="serif text-4xl md:text-5xl italic gold-text mb-12">Le Geste Humain au Cœur de l'Atlas</h2>
            </div>

            <div class="space-y-12 text-center md:text-left">
                <div class="fade-in">
                    <p class="serif text-xl md:text-2xl text-primary italic leading-relaxed mb-6">
                        "Tout commence par une rencontre au cœur des montagnes du Souss. Chez IDYL, nous avons choisi de
                        supprimer tous les intermédiaires pour nous rendre là où bat le cœur du savoir-faire : dans les
                        villages reculés, auprès des femmes artisanes."
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                    <div class="fade-in" style="transition-delay: 0.2s;">
                        <img src="image.06.jpeg" alt="Artisanat"
                            class="w-full h-80 object-cover grayscale opacity-80 hover:grayscale-0 transition-all duration-1000 rounded-sm shadow-2xl">
                    </div>
                    <div class="fade-in" style="transition-delay: 0.4s;">
                        <p class="text-secondary font-light leading-relaxed text-lg mb-6">
                            Nous achetons notre huile directement à ces femmes qui vivent et travaillent au village. Ce
                            sont elles qui, d'un geste patient et précis, produisent notre huile d'argan 100%
                            'Handmade'.
                        </p>
                        <p
                            class="text-secondary font-light leading-relaxed text-lg italic border-l-2 border-gold/30 pl-4">
                            Chaque goutte est le fruit d'un travail manuel qui respecte le rythme de la nature et la
                            dignité de celles qui la façonnent.
                        </p>
                    </div>
                </div>

                <div class="fade-in pt-12 border-t border-neutral-900" style="transition-delay: 0.6s;">
                    <p class="serif text-2xl md:text-3xl text-muted-gold italic text-center max-w-3xl mx-auto">
                        "En choisissant IDYL, vous ne choisissez pas seulement un soin d'exception ; vous soutenez
                        directement l'économie de ces villages et préservez une tradition que seule la main humaine peut
                        porter à ce niveau de perfection."
                    </p>
                    <p class="text-center mt-8 gold-text uppercase tracking-[4px] text-xs font-bold">C’est cette
                        transparence totale que nous vous invitons à découvrir.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Collection Section -->
    <section id="collection" class="py-32 bg-elevated px-10">
        <div class="text-center mb-24">
            <h2 class="serif text-5xl mb-4 italic">The Essentials</h2>
            <p class="text-neutral-500 uppercase tracking-widest text-[10px]">Three icons of purity</p>
        </div>

        <div id="product-grid" class="grid grid-cols-1 md:grid-cols-4 gap-8 max-w-7xl mx-auto">
            <!-- Product 1 -->
            <div class="product-card fade-in" draggable="true" data-id="product-1">
                <div class="bg-accent aspect-[3/4] mb-8 overflow-hidden group cursor-pointer relative">
                    <img src="image222.png" class="w-full h-full object-cover opacity-80 cursor-zoom-in"
                        alt="Argan Eye Patches" onclick="standoutProduct(this)">
                </div>
                <div class="flex justify-between items-baseline mb-2">
                    <h3 class="serif text-2xl">Argan Eye Patches</h3>
                    <span class="text-primary font-light">490 DH</span>
                </div>
                <p class="gold-text text-xs uppercase tracking-[3px] mb-4">World Exclusive Innovation</p>
                <div class="space-y-4">
                    <p class="text-neutral-500 text-[11px] font-light leading-relaxed">
                        <strong>Innovation:</strong> Une innovation technologique mondiale utilisant la bio-cellulose
                        pour infuser un sérum d'argan pur directement dans la zone délicate du regard.
                    </p>
                    <p class="text-secondary text-[11px] italic font-light leading-relaxed">
                        <strong>Promesse:</strong> Une régénération cellulaire immédiate pour un regard reposé et
                        éclatant de lumière.
                    </p>
                </div>
                <div class="flex flex-col gap-3 mt-6">
                    <button onclick="openModal('Argan Eye Patches', 490)"
                        class="btn-luxury w-full text-[10px] py-4 bg-primary text-base hover:bg-gold transition-colors">Acheter
                        Maintenant</button>
                    <button onclick="addToCart('Argan Eye Patches', 490, 'image222.png', event)"
                        class="btn-luxury-outline w-full text-[10px] py-4">Ajouter au Panier</button>
                </div>
            </div>

            <!-- Product 2 -->
            <div class="product-card fade-in" draggable="true" data-id="product-2" style="transition-delay: 0.2s;">
                <div class="bg-accent aspect-[3/4] mb-8 overflow-hidden group cursor-pointer relative">
                    <img src="image444.png" class="w-full h-full object-cover opacity-80 cursor-zoom-in"
                        alt="The Silk Face Mask" onclick="standoutProduct(this)">
                </div>
                <div class="flex justify-between items-baseline mb-2">
                    <h3 class="serif text-2xl">The Silk Face Mask</h3>
                    <span class="text-primary font-light">320 DH</span>
                </div>
                <p class="gold-text text-xs uppercase tracking-[3px] mb-4">Sensorial Purity</p>
                <div class="space-y-4">
                    <p class="text-neutral-500 text-[11px] font-light leading-relaxed">
                        <strong>Innovation:</strong> Un masque cocon ultra-nourrissant qui fusionne la pureté de
                        l'extrait d'argan avec les essences botaniques les plus précieuses de l'Atlas.
                    </p>
                    <p class="text-secondary text-[11px] italic font-light leading-relaxed">
                        <strong>Promesse:</strong> Une expérience sensorielle unique pour une peau repulpée, douce comme
                        de la soie.
                    </p>
                </div>
                <div class="flex flex-col gap-3 mt-6">
                    <button onclick="openModal('The Silk Face Mask', 320)"
                        class="btn-luxury w-full text-[10px] py-4 bg-primary text-base hover:bg-gold transition-colors">Acheter
                        Maintenant</button>
                    <button onclick="addToCart('The Silk Face Mask', 320, 'image444.png', event)"
                        class="btn-luxury-outline w-full text-[10px] py-4">Ajouter au Panier</button>
                </div>
            </div>

            <!-- Product 3 -->
            <div class="product-card fade-in" draggable="true" data-id="product-3" style="transition-delay: 0.4s;">
                <div class="bg-accent aspect-[3/4] mb-8 overflow-hidden group cursor-pointer relative">
                    <img src="image555.png" class="w-full h-full object-cover opacity-80 cursor-zoom-in"
                        alt="Le Savon de Face Artisanal" onclick="standoutProduct(this)">
                </div>
                <div class="flex justify-between items-baseline mb-2">
                    <h3 class="serif text-2xl">Le Savon de Face Artisanal</h3>
                    <span class="text-primary font-light">180 DH</span>
                </div>
                <p class="gold-text text-xs uppercase tracking-[3px] mb-4">Ancestral Craft</p>
                <div class="space-y-4">
                    <p class="text-neutral-500 text-[11px] font-light leading-relaxed">
                        <strong>Innovation:</strong> Un soin lavant saponifié à froid pendant 6 semaines, respectant le
                        cycle de maturation naturel pour préserver les actifs.
                    </p>
                    <p class="text-secondary text-[11px] italic font-light leading-relaxed">
                        <strong>Promesse:</strong> Un nettoyage profond qui ne décapage pas la peau, laissant un film
                        lipidique protecteur et une sensation de confort absolu.
                    </p>
                </div>
                <div class="flex flex-col gap-3 mt-6">
                    <button onclick="openModal('Le Savon de Face Artisanal', 180)"
                        class="btn-luxury w-full text-[10px] py-4 bg-primary text-base hover:bg-gold transition-colors">Acheter
                        Maintenant</button>
                    <button onclick="addToCart('Le Savon de Face Artisanal', 180, 'image555.png', event)"
                        class="btn-luxury-outline w-full text-[10px] py-4">Ajouter au Panier</button>
                </div>
            </div>

            <!-- Product 4 -->
            <div class="product-card fade-in" draggable="true" data-id="product-4" style="transition-delay: 0.6s;">
                <div class="bg-accent aspect-[3/4] mb-8 overflow-hidden group cursor-pointer relative">
                    <img src="image88.png" class="w-full h-full object-cover opacity-80 cursor-zoom-in"
                        alt="Huile d'Argan" onclick="standoutProduct(this)">
                </div>
                <div class="flex justify-between items-baseline mb-2">
                    <h3 class="serif text-2xl">Huile d'Argan</h3>
                    <span class="text-primary font-light">60 DH</span>
                </div>
                <p class="gold-text text-xs uppercase tracking-[3px] mb-4">Liquid Gold</p>
                <div class="space-y-4">
                    <p class="text-neutral-500 text-[11px] font-light leading-relaxed">
                        <strong>Description:</strong> L'essence même d'IDYL. Une huile organique pure, pressée à la main
                        et extraite à froid pour garantir une concentration maximale en Vitamine E.
                    </p>
                    <p class="text-secondary text-[11px] italic font-light leading-relaxed">
                        <strong>Promesse:</strong> Une nutrition intense et une protection antioxydante pour révéler la
                        lumière naturelle du teint.
                    </p>
                </div>
                <div class="flex flex-col gap-3 mt-6">
                    <button onclick="openModal('Huile d\'Argan', 60)"
                        class="btn-luxury w-full text-[10px] py-4 bg-primary text-base hover:bg-gold transition-colors">Acheter
                        Maintenant</button>
                    <button onclick="addToCart('Huile d\'Argan', 60, 'image88.png', event)"
                        class="btn-luxury-outline w-full text-[10px] py-4">Ajouter au Panier</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="py-32 bg-base overflow-hidden border-t border-neutral-800">
        <div class="max-w-6xl mx-auto px-10">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-16">
                <div class="fade-in">
                    <div class="gold-text text-xs mb-6 uppercase tracking-[4px] font-bold">LE TÉMOIGNAGE</div>
                    <p class="serif text-xl italic text-primary leading-relaxed mb-8">
                        "Une texture divine qui fusionne instantanément avec la peau. Mon rituel du soir est devenu un
                        moment de pure sérénité."
                    </p>
                    <div class="flex items-center gap-4">
                        <div class="w-8 h-[1px] bg-neutral-700"></div>
                        <span class="text-[10px] uppercase tracking-[4px] text-neutral-500">Sophie L., Paris</span>
                    </div>
                </div>
                <div class="fade-in" style="transition-delay: 0.2s;">
                    <div class="gold-text text-xs mb-6 uppercase tracking-[4px] font-bold">L'EXPÉRIENCE</div>
                    <p class="serif text-xl italic text-primary leading-relaxed mb-8">
                        "L'Huile d'Argan IDYL est incomparable. On sent la pureté du geste artisanal dès la première
                        application. Spectaculaire."
                    </p>
                    <div class="flex items-center gap-4">
                        <div class="w-8 h-[1px] bg-neutral-700"></div>
                        <span class="text-[10px] uppercase tracking-[4px] text-neutral-500">Marc V., Marrakech</span>
                    </div>
                </div>
                <div class="fade-in" style="transition-delay: 0.4s;">
                    <div class="gold-text text-xs mb-6 uppercase tracking-[4px] font-bold">L'EXCEPTION</div>
                    <p class="serif text-xl italic text-primary leading-relaxed mb-8">
                        "Enfin une marque qui respecte l'âme de l'Argan tout en proposant une esthétique d'un luxe
                        absolu. Un chef-d'œuvre."
                    </p>
                    <div class="flex items-center gap-4">
                        <div class="w-8 h-[1px] bg-neutral-700"></div>
                        <span class="text-[10px] uppercase tracking-[4px] text-neutral-500">Elena R., London</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Core Values -->
    <section class="pb-32 px-10 max-w-6xl mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-16 text-center">
            <div class="fade-in">
                <div class="serif text-3xl mb-4">Technical Innovation</div>
                <p class="text-neutral-500 text-[10px] font-light leading-loose uppercase tracking-[4px]">BRIDGING THE
                    GAP
                    BETWEEN BIOTECHNOLOGY AND NATURE.</p>
            </div>
            <div class="fade-in" style="transition-delay: 0.2s;">
                <div class="serif text-3xl mb-4">Social Impact</div>
                <p class="text-neutral-500 text-[10px] font-light leading-loose uppercase tracking-[4px]">EMPOWERING THE
                    WOMEN COOPERATIVES OF THE SOUSS REGION.</p>
            </div>
            <div class="fade-in" style="transition-delay: 0.4s;">
                <div class="serif text-3xl mb-4">Sensorial Purity</div>
                <p class="text-neutral-500 text-[10px] font-light leading-loose uppercase tracking-[4px]">
                    FRAGRANCE-FREE,
                    RAW MATERIALS, ABSOLUTE SILENCE FOR THE SKIN.</p>
            </div>
        </div>
    </section>

    <!-- Rituals Section -->
    <section class="py-32 bg-base px-10">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-24 fade-in">
                <p class="uppercase tracking-[6px] text-[10px] mb-4 text-neutral-500">L'Art du Soin</p>
                <h2 class="serif text-5xl italic gold-text">Les Rituels IDYL</h2>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
                <!-- Step 1 -->
                <div class="fade-in group">
                    <div class="relative mb-10 overflow-hidden aspect-[3/4]">
                        <img src="image555.png"
                            class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-1000"
                            alt="Purifier">
                        <div class="absolute top-6 left-6 text-5xl serif italic gold-text opacity-50">01</div>
                    </div>
                    <h3 class="serif text-2xl mb-4">Purifier</h3>
                    <p class="text-neutral-500 font-light leading-relaxed mb-4">
                        Préparez votre peau avec <strong>Le Savon de Face Artisanal</strong>. Une mousse onctueuse qui
                        libère délicatement les impuretés tout en respectant l'équilibre lipidique naturel de votre
                        visage.
                    </p>
                    <p class="text-secondary text-sm italic font-light mb-6">
                        <strong>L'Effet :</strong> Une peau saine, fraîche et parfaitement préparée à recevoir les soins
                        suivants.
                    </p>
                    <div class="flex flex-col gap-3 mt-8">
                        <button onclick="openModal('Le Savon de Face Artisanal', 180)"
                            class="btn-luxury w-full text-[10px] py-4 bg-primary text-base hover:bg-gold transition-colors">Acheter
                            Maintenant</button>
                        <button onclick="addToCart('Le Savon de Face Artisanal', 180, 'image555.png', event)"
                            class="btn-luxury-outline w-full text-[10px] py-4">Ajouter au Panier</button>
                    </div>
                </div>

                <!-- Step 2 -->
                <div class="fade-in group" style="transition-delay: 0.2s;">
                    <div class="relative mb-10 overflow-hidden aspect-[3/4]">
                        <img src="image444.png"
                            class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-1000"
                            alt="Apaiser">
                        <div class="absolute top-6 left-6 text-5xl serif italic gold-text opacity-50">02</div>
                    </div>
                    <h3 class="serif text-2xl mb-4">Apaiser</h3>
                    <p class="text-neutral-500 font-light leading-relaxed mb-4">
                        Appliquez <strong>The Silk Face Mask</strong>. Laissez la technologie de la bio-cellulose
                        infuser intensément les actifs d'argan au plus profond de vos cellules.
                    </p>
                    <p class="text-secondary text-sm italic font-light mb-6">
                        <strong>L'Effet :</strong> Une renaissance immédiate pour les peaux fatiguées, laissant le teint
                        apaisé et intensément ressourcé.
                    </p>
                    <div class="flex flex-col gap-3 mt-8">
                        <button onclick="openModal('The Silk Face Mask', 320)"
                            class="btn-luxury w-full text-[10px] py-4 bg-primary text-base hover:bg-gold transition-colors">Acheter
                            Maintenant</button>
                        <button onclick="addToCart('The Silk Face Mask', 320, 'image444.png', event)"
                            class="btn-luxury-outline w-full text-[10px] py-4">Ajouter au Panier</button>
                    </div>
                </div>

                <!-- Step 3 -->
                <div class="fade-in group" style="transition-delay: 0.4s;">
                    <div class="relative mb-10 overflow-hidden aspect-[3/4]">
                        <img src="image88.png"
                            class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-1000"
                            alt="Sublimer">
                        <div class="absolute top-6 left-6 text-5xl serif italic gold-text opacity-50">03</div>
                    </div>
                    <h3 class="serif text-2xl mb-4">Sublimer</h3>
                    <p class="text-neutral-500 font-light leading-relaxed mb-4">
                        Scellez l'hydratation avec quelques gouttes de notre <strong>Huile d'Argan</strong> pure. Une
                        caresse finale qui apporte une nutrition absolue et une protection antioxydante durable.
                    </p>
                    <p class="text-secondary text-sm italic font-light mb-6">
                        <strong>L'Effet :</strong> Un éclat éternel et une peau visiblement sublimée, rayonnante de la
                        lumière originelle du Souss.
                    </p>
                    <div class="flex flex-col gap-3 mt-8">
                        <button onclick="openModal('Huile d\'Argan', 60)"
                            class="btn-luxury w-full text-[10px] py-4 bg-primary text-base hover:bg-gold transition-colors">Acheter
                            Maintenant</button>
                        <button onclick="addToCart('Huile d\'Argan', 60, 'image88.png', event)"
                            class="btn-luxury-outline w-full text-[10px] py-4">Ajouter au Panier</button>
                    </div>
                </div>
            </div>

            <div class="text-center mt-20 fade-in">
                <button onclick="addFullRitual()"
                    class="btn-luxury py-5 px-12 bg-primary text-base hover:bg-gold shadow-[0_0_30px_rgba(197,160,89,0.3)]">
                    COMMANDER LE RITUEL COMPLET (560 DH)
                </button>
                <p class="text-[10px] uppercase tracking-[4px] text-neutral-500 mt-6">Économisez du temps, commandez
                    l'ensemble du soin ancestral</p>
            </div>
        </div>
    </section>

    <!-- Customer Reviews (Testimonials) Section -->
    <section id="testimonials" class="py-32 bg-base px-10">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-24 fade-in">
                <p class="uppercase tracking-[6px] text-[10px] mb-4 text-neutral-500">Témoignages</p>
                <h2 class="serif text-5xl italic gold-text">Avis de nos Client(e)s</h2>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
                <!-- Testimonial 1 -->
                <div class="fade-in testimonial-card group">
                    <div class="flex justify-center mb-6 text-gold">
                        <span class="text-xl">★★★★★</span>
                    </div>
                    <p class="serif text-xl text-muted-gold italic mb-8 leading-relaxed">
                        "Une texture divine qui fusionne instantanément avec la peau. Mon rituel du soir est devenu un
                        moment de pure sérénité."
                    </p>
                    <div class="border-t border-neutral-800 pt-6">
                        <p class="text-primary uppercase tracking-widest text-xs font-bold mb-1">Sarah M.</p>
                        <p class="text-gold text-[10px] uppercase tracking-widest italic">Huile d'Argan Pure</p>
                    </div>
                </div>

                <!-- Testimonial 2 -->
                <div class="fade-in testimonial-card group" style="transition-delay: 0.2s;">
                    <div class="flex justify-center mb-6 text-gold">
                        <span class="text-xl">★★★★★</span>
                    </div>
                    <p class="serif text-xl text-muted-gold italic mb-8 leading-relaxed">
                        "L'Huile d'Argan IDYL est incomparable. On sent la pureté du geste artisanal dès la première
                        application. Spectaculaire."
                    </p>
                    <div class="border-t border-neutral-800 pt-6">
                        <p class="text-primary uppercase tracking-widest text-xs font-bold mb-1">Leila K.</p>
                        <p class="text-gold text-[10px] uppercase tracking-widest italic">Le Savon Artisanal</p>
                    </div>
                </div>

                <!-- Testimonial 3 -->
                <div class="fade-in testimonial-card group" style="transition-delay: 0.4s;">
                    <div class="flex justify-center mb-6 text-gold">
                        <span class="text-xl">★★★★★</span>
                    </div>
                    <p class="serif text-xl text-muted-gold italic mb-8 leading-relaxed">
                        "Enfin une marque qui respecte l'âme de l'Argan tout en proposant une esthétique d'un luxe
                        absolu. Un chef-d'œuvre."
                    </p>
                    <div class="border-t border-neutral-800 pt-6">
                        <p class="text-primary uppercase tracking-widest text-xs font-bold mb-1">Amine B.</p>
                        <p class="text-gold text-[10px] uppercase tracking-widest italic">The Silk Face Mask</p>
                    </div>
                </div>
            </div>

            <!-- Review Entry Button -->
            <div class="text-center mt-20 fade-in">
                <button onclick="openReviewModal()" class="btn-luxury py-4 px-12">
                    LAISSER UN AVIS
                </button>
            </div>
        </div>
    </section>

    <!-- Digital Journey / Concierge -->
    <section id="concierge" class="py-32 bg-base text-primary relative overflow-hidden">
        <!-- Particle Canvas -->
        <canvas id="particle-canvas" class="absolute inset-0 pointer-events-none"></canvas>

        <div class="max-w-7xl mx-auto px-10 relative z-10">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-20 items-center">
                <!-- Image side with float animation -->
                <div class="fade-in flex justify-center lg:justify-start lg:-ml-12 order-2 lg:order-1"
                    id="concierge-tilt-container" style="perspective: 1000px;">
                    <div class="relative group" id="concierge-tilt-element"
                        style="transform-style: preserve-3d; transition: transform 0.1s ease-out;">
                        <div
                            class="absolute -inset-10 bg-gold/10 blur-3xl rounded-full scale-0 group-hover:scale-100 transition-transform duration-1000">
                        </div>
                        <img src="image.08.png" alt="Concierge"
                            class="w-full max-w-md float-animation opacity-90 drop-shadow-[0_20px_50px_rgba(197,160,89,0.1)]">
                    </div>
                </div>

                <!-- Text side -->
                <div class="fade-in order-1 lg:order-2">
                    <p class="uppercase tracking-[6px] text-[10px] mb-6 gold-text font-bold">CONCIERGERIE DIGITALE</p>
                    <h2 class="serif text-4xl md:text-6xl mb-12 italic leading-tight text-primary">Une Conversation
                        <br>Particulière
                    </h2>

                    <div class="space-y-12">
                        <div class="border-l-2 border-white/20 pl-8">
                            <h4 class="serif text-2xl mb-4 italic">1. Éducation & Transparence</h4>
                            <p class="text-secondary font-light leading-relaxed">
                                Chaque étape de notre production est documentée. Plongez dans notre storytelling
                                Instagram ou explorez nos guides techniques pour comprendre l'alchimie de l'Argan.
                            </p>
                        </div>
                        <div class="border-l-2 border-white/20 pl-8">
                            <h4 class="serif text-2xl mb-4 italic">2. Consultation Directe</h4>
                            <p class="text-secondary font-light leading-relaxed mb-8">
                                Besoin d'un diagnostic personnalisé ? Nos experts vous répondent via notre service de
                                Conciergerie WhatsApp.
                            </p>
                            <div class="flex flex-wrap gap-4">
                                <a href="https://wa.me/212605764173"
                                    class="btn-luxury border-white text-primary hover:bg-white hover:text-black transition-all">LANCER
                                    LA DISCUSSION</a>
                                <a href="https://instagram.com/id_yl_maroc" target="_blank"
                                    class="btn-luxury border-gold/30 text-gold hover:bg-gold hover:text-black transition-all">INSTAGRAM</a>
                                <a href="mailto:bouhajahoussam234@gmail.com"
                                    class="btn-luxury border-neutral-700 text-secondary hover:bg-neutral-800 transition-all">EMAIL</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Product Standout Overlay -->
    <div id="product-standout-overlay" class="fixed inset-0 z-[200] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-xl" onclick="closeStandout()"></div>
        <div class="relative max-w-4xl w-full flex flex-col md:flex-row gap-12 items-center fade-in visible">
            <button onclick="closeStandout()"
                class="absolute -top-12 right-0 text-primary text-4xl hover:text-gold transition-colors">&times;</button>
            <div id="standout-content" class="w-full">
                <!-- Content will be injected by JS -->
            </div>
        </div>
    </div>

    <!-- Cart Drawer -->
    <div id="cart-drawer"
        class="fixed top-0 right-0 w-full max-w-md h-full bg-base z-[150] translate-x-full transition-transform duration-700 ease-[cubic-bezier(0.16,1,0.3,1)] border-l border-white/5 flex flex-col">
        <div class="p-8 flex justify-between items-center border-b border-white/5">
            <h3 class="serif text-2xl italic gold-text">Votre Panier</h3>
            <button onclick="toggleCart()"
                class="text-[10px] uppercase tracking-[4px] text-neutral-500 hover:text-primary transition-colors">Fermer</button>
        </div>

        <div id="cart-items" class="flex-1 overflow-y-auto p-8 space-y-8">
            <!-- Items will be injected here -->
        </div>

        <div class="p-8 bg-accent/40 space-y-6">
            <div class="flex justify-between items-baseline">
                <span class="text-[10px] uppercase tracking-[4px] text-neutral-500">Total</span>
                <span id="cart-total" class="serif text-2xl gold-text font-bold">0 DH</span>
            </div>
            <button onclick="checkoutCart()" class="btn-luxury w-full font-bold tracking-[4px] text-xs py-5">
                PASSER LA COMMANDE
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer id="contact" class="py-20 px-10 text-center border-t border-neutral-800 text-secondary">
        <div class="serif text-2xl mb-8 gold-text">IDYL</div>
        <div class="flex justify-center items-center gap-10 mb-12">
            <a href="https://instagram.com/id_yl_maroc" target="_blank" class="social-icon-wrapper group">
                <img src="1658588965instagram-logo-png-transparent-background.webp" alt="Instagram" class="social-icon">
                <span class="social-label">Instagram</span>
            </a>
            <a href="https://wa.me/212605764173" target="_blank" class="social-icon-wrapper group">
                <img src="whatsapp-icon-free-png.webp" alt="WhatsApp" class="social-icon">
                <span class="social-label">WhatsApp</span>
            </a>
            <a href="mailto:bouhajahoussam234@gmail.com" class="social-icon-wrapper group">
                <img src="gmail-email-logo-png-16.png" alt="Email" class="social-icon">
                <span class="social-label">Email</span>
            </a>
            <a href="tel:+212605764173" class="social-icon-wrapper group">
                <svg class="social-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path
                        d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z">
                    </path>
                </svg>
                <span class="social-label">APPEL</span>
            </a>
        </div>
        <div class="flex flex-col gap-4 mt-8">
            <p class="text-[9px] uppercase tracking-[6px] gold-text opacity-80 font-bold">Made in Morocco</p>
            <p class="text-[9px] uppercase tracking-[4px] gold-text opacity-60">© 2024 Maison IDYL — Artisanat de Luxe
                du Souss</p>
        </div>
    </footer>

    <!-- Review Modal -->
    <div id="reviewModal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/10 backdrop-blur-[2px]" onclick="closeReviewModal()"></div>
        <div
            class="absolute top-[40%] left-1/2 -translate-x-1/2 -translate-y-[40%] w-full max-w-lg bg-base border border-gold/20 p-8 shadow-2xl fade-in visible rounded-sm">
            <div class="relative flex justify-center items-center mb-8">
                <h3 class="serif text-3xl gold-text italic tracking-wide">Votre Expérience</h3>
                <button onclick="closeReviewModal()"
                    class="absolute right-0 text-secondary hover:text-primary text-2xl">&times;</button>
            </div>

            <form id="reviewForm" onsubmit="submitReview(event)" class="flex flex-col gap-6">
                <div class="space-y-4">
                    <input type="text" id="reviewName" placeholder="Votre Nom" required
                        class="w-full bg-accent/30 border-b border-neutral-700 py-3 px-4 text-sm text-primary focus:border-gold outline-none transition-all placeholder:text-neutral-500">

                    <select id="reviewProduct" required
                        class="w-full bg-accent/30 border-b border-neutral-700 py-3 px-4 text-sm text-primary focus:border-gold outline-none transition-all appearance-none cursor-pointer">
                        <option value="" disabled selected>Produit concerné</option>
                        <option value="Huile d'Argan Pure">Huile d'Argan Pure</option>
                        <option value="Le Savon Artisanal">Le Savon Artisanal</option>
                        <option value="The Silk Face Mask">The Silk Face Mask</option>
                    </select>

                    <div class="flex flex-col items-center gap-2 py-2">
                        <label class="text-[10px] uppercase tracking-[3px] text-neutral-500 mb-2">Notez votre
                            expérience</label>
                        <div class="flex gap-2 text-2xl" id="star-rating">
                            <span class="star cursor-pointer text-neutral-700 hover:text-gold transition-colors"
                                data-rating="1">★</span>
                            <span class="star cursor-pointer text-neutral-700 hover:text-gold transition-colors"
                                data-rating="2">★</span>
                            <span class="star cursor-pointer text-neutral-700 hover:text-gold transition-colors"
                                data-rating="3">★</span>
                            <span class="star cursor-pointer text-neutral-700 hover:text-gold transition-colors"
                                data-rating="4">★</span>
                            <span class="star cursor-pointer text-neutral-700 hover:text-gold transition-colors"
                                data-rating="5">★</span>
                        </div>
                        <input type="hidden" id="reviewRating" value="5">
                    </div>

                    <textarea id="reviewText" placeholder="Partagez votre avis..." required rows="4"
                        class="w-full bg-accent/30 border border-neutral-700 p-4 text-sm text-primary focus:border-gold outline-none transition-all placeholder:text-neutral-500 resize-none rounded-sm"></textarea>
                </div>

                <button type="submit" class="btn-luxury w-full font-bold tracking-[4px] text-xs py-5">
                    PUBLIER L'AVIS
                </button>
            </form>
        </div>
    </div>

    <!-- Order Modal -->
    <div id="orderModal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-black/10 backdrop-blur-[2px]" onclick="closeModal()"></div>
        <div
            class="absolute top-[40%] left-1/2 -translate-x-1/2 -translate-y-[40%] w-full max-w-lg bg-base border border-gold/20 p-6 shadow-2xl fade-in visible rounded-sm max-h-[95vh] overflow-y-auto">
            <div class="relative flex justify-center items-center mb-6">
                <h3 class="serif text-2xl gold-text italic tracking-wide">Votre Commande</h3>
                <button onclick="closeModal()"
                    class="absolute right-0 text-secondary hover:text-primary text-xl">&times;</button>
            </div>

            <form id="orderForm" onsubmit="submitOrder(event)" class="flex flex-col gap-4">
                <input type="hidden" id="productName">

                <div class="flex flex-col gap-1 text-center border-b border-neutral-800 pb-4 mb-2">
                    <label class="text-[10px] uppercase tracking-[2px] text-neutral-500">Produit Sélectionné</label>
                    <div id="displayProductName" class="text-lg serif text-primary"></div>
                    <div id="displayProductPrice" class="text-base gold-text font-medium"></div>
                </div>

                <div class="space-y-3">
                    <input type="text" id="fullName" placeholder="Nom Complet" required
                        class="w-full bg-accent/30 border-b border-neutral-700 py-3 px-4 text-sm text-primary focus:border-gold focus:bg-accent/50 outline-none transition-all placeholder:text-neutral-500 rounded-t-sm">

                    <input type="tel" id="phone" placeholder="Numéro de Téléphone" required
                        class="w-full bg-accent/30 border-b border-neutral-700 py-3 px-4 text-sm text-primary focus:border-gold focus:bg-accent/50 outline-none transition-all placeholder:text-neutral-500 rounded-t-sm">

                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" id="city" placeholder="Ville" required
                            class="w-full bg-accent/30 border-b border-neutral-700 py-3 px-4 text-sm text-primary focus:border-gold focus:bg-accent/50 outline-none transition-all placeholder:text-neutral-500 rounded-t-sm">
                        <input type="number" id="quantity" value="1" min="1" required
                            class="w-full bg-accent/30 border-b border-neutral-700 py-3 px-4 text-sm text-primary focus:border-gold focus:bg-accent/50 outline-none transition-all placeholder:text-neutral-500 rounded-t-sm">
                    </div>

                    <input type="text" id="address" placeholder="Adresse de Livraison" required
                        class="w-full bg-accent/30 border-b border-neutral-700 py-3 px-4 text-sm text-primary focus:border-gold focus:bg-accent/50 outline-none transition-all placeholder:text-neutral-500 rounded-t-sm">
                </div>

                <div class="mt-4 p-4 bg-gold/5 border border-gold/10 rounded-sm text-center">
                    <p class="text-[10px] uppercase tracking-[3px] text-gold font-bold mb-1">Mode de Paiement</p>
                    <p class="serif text-primary italic">Paiement à la livraison (Cash on Delivery)</p>
                </div>

                <button type="submit"
                    class="btn-luxury w-full mt-6 font-bold tracking-[4px] text-xs py-4 shadow-[0_0_20px_rgba(197,160,89,0.3)] hover:shadow-[0_0_30px_rgba(197,160,89,0.5)] transform hover:-translate-y-1 transition-all duration-300">
                    CONFIRMER SUR WHATSAPP
                </button>
            </form>
        </div>
    </div>

    <script>
        // Intersection Observer for fade-in animations
        const observerOptions = {
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    // Also trigger line-draw if it's inside
                    const line = entry.target.querySelector('.line-draw');
                    if (line) line.classList.add('visible');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

        // Smooth Scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Parallax and Header Glassmorphism
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            const nav = document.getElementById('main-nav');
            const heroText = document.querySelector('.hero-video-container .relative');

            // Glassmorphism toggle
            if (scrolled > 50) {
                nav.classList.add('scrolled');
                nav.classList.remove('mix-blend-difference');
            } else {
                nav.classList.remove('scrolled');
                nav.classList.add('mix-blend-difference');
            }

            if (heroText) {
                heroText.style.transform = `translateY(${scrolled * 0.3}px)`;
                heroText.style.opacity = 1 - (scrolled / 800);
            }
        });

        // Mobile Menu Toggle
        const hamburger = document.getElementById('hamburger');
        const mobileMenu = document.getElementById('mobile-menu');

        hamburger.addEventListener('click', toggleMenu);

        // Theme Toggle Logic
        function initTheme() {
            const savedTheme = localStorage.getItem('idyl-theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcons(savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('idyl-theme', newTheme);
            updateThemeIcons(newTheme);
        }

        function updateThemeIcons(theme) {
            const sun = document.getElementById('theme-icon-sun');
            const moon = document.getElementById('theme-icon-moon');
            if (theme === 'dark') {
                sun.classList.remove('hidden');
                moon.classList.add('hidden');
            } else {
                sun.classList.add('hidden');
                moon.classList.remove('hidden');
            }
        }

        initTheme();

        // Shopping Cart Logic
        let cart = [];
        try {
            const savedCart = localStorage.getItem('idyl-cart');
            if (savedCart) {
                cart = JSON.parse(savedCart) || [];
            }
        } catch (e) {
            console.error("Cart loading failed", e);
            cart = [];
        }

        function updateCartUI() {
            const container = document.getElementById('cart-items');
            const totalEl = document.getElementById('cart-total');
            const countEl = document.getElementById('cart-count');

            if (cart.length === 0) {
                container.innerHTML = '<div class="h-full flex items-center justify-center text-neutral-500 italic">Votre panier est vide</div>';
                totalEl.innerText = '0 DH';
                countEl.style.opacity = '0';
                return;
            }

            countEl.style.opacity = '1';
            countEl.innerText = cart.reduce((acc, item) => acc + item.quantity, 0);

            container.innerHTML = cart.map((item, index) => `
                <div class="flex gap-6 group">
                    <div class="w-20 aspect-[3/4] overflow-hidden bg-accent">
                        <img src="${item.image}" class="w-full h-full object-cover">
                    </div>
                    <div class="flex-1 flex flex-col justify-between py-1">
                        <div>
                            <div class="flex justify-between items-start mb-1">
                                <h4 class="serif text-lg">${item.name}</h4>
                                <button onclick="removeFromCart(${index})" class="text-secondary hover:text-primary text-sm">Supprimer</button>
                            </div>
                            <p class="gold-text text-sm">${item.price} DH</p>
                        </div>
                        <div class="flex items-center gap-4">
                            <div class="flex items-center border border-white/10 rounded-full px-3 py-1 gap-4">
                                <button onclick="updateQty(${index}, -1)" class="text-neutral-500 hover:text-primary">-</button>
                                <span class="text-xs font-light">${item.quantity}</span>
                                <button onclick="updateQty(${index}, 1)" class="text-neutral-500 hover:text-primary">+</button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            const total = cart.reduce((acc, item) => acc + (item.price * item.quantity), 0);
            totalEl.innerText = total + ' DH';

            localStorage.setItem('idyl-cart', JSON.stringify(cart));
        }

        function addToCart(name, price, image, event) {
            console.log("Adding to cart:", name);
            const evt = event || window.event;

            // Safety checks for parameters
            const productName = name || "Produit IDYL";
            const productPrice = parseFloat(price) || 0;
            const productImg = image || "image.07.png";

            try {
                const existing = cart.find(item => item.name === productName);
                if (existing) {
                    existing.quantity++;
                } else {
                    cart.push({ name: productName, price: productPrice, image: productImg, quantity: 1 });
                }

                updateCartUI();
                showToast(`Ajouté : ${productName}`);

                // Pulse the cart icon
                const cartBtn = document.getElementById('cart-btn-nav');
                if (cartBtn) {
                    cartBtn.classList.remove('cart-pulse');
                    void cartBtn.offsetWidth;
                    cartBtn.classList.add('cart-pulse');
                }

                // Open cart immediately for direct feedback
                const drawer = document.getElementById('cart-drawer');
                if (drawer && !drawer.classList.contains('active')) {
                    toggleCart();
                }

                // Trigger animation if event exists
                if (evt && evt.target) {
                    const btn = evt.target.closest('button');
                    if (btn) {
                        const productImgEl = btn.closest('.product-card')?.querySelector('img') ||
                            btn.closest('.grid')?.querySelector('img') ||
                            btn.closest('.group')?.querySelector('img');

                        if (productImgEl) flyToCart(productImgEl);
                    }
                }
            } catch (err) {
                console.error("Critical error in addToCart:", err);
            }
        }

        function showToast(message) {
            const container = document.getElementById('toast-container');
            if (!container) return;

            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `<span>✓</span> <span>${message}</span>`;
            container.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'toast-out 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards';
                setTimeout(() => toast.remove(), 600);
            }, 3000);
        }

        function flyToCart(imgElement) {
            const cartIcon = document.getElementById('cart-btn-nav');
            if (!cartIcon || !imgElement) return;

            const rect = imgElement.getBoundingClientRect();
            const cartRect = cartIcon.getBoundingClientRect();

            const clone = imgElement.cloneNode();
            clone.classList.add('flying-item');

            clone.style.width = rect.width + 'px';
            clone.style.height = rect.height + 'px';
            clone.style.top = rect.top + 'px';
            clone.style.left = rect.left + 'px';

            document.body.appendChild(clone);

            // Animate
            requestAnimationFrame(() => {
                clone.style.width = '20px';
                clone.style.height = '20px';
                clone.style.top = (cartRect.top + 10) + 'px';
                clone.style.left = (cartRect.left + 10) + 'px';
                clone.style.opacity = '0';
            });

            setTimeout(() => {
                clone.remove();
            }, 800);
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
        }

        function updateQty(index, delta) {
            cart[index].quantity += delta;
            if (cart[index].quantity < 1) cart.splice(index, 1);
            updateCartUI();
        }

        function toggleCart() {
            const drawer = document.getElementById('cart-drawer');
            drawer.classList.toggle('translate-x-full');
            drawer.classList.toggle('active'); // Used for tracking
            document.body.style.overflow = drawer.classList.contains('active') ? 'hidden' : '';
        }

        function checkoutCart() {
            if (cart.length === 0) return;
            const productNames = cart.map(item => `${item.name} (x${item.quantity})`).join(', ');
            const totalPrice = cart.reduce((acc, item) => acc + (item.price * item.quantity), 0);
            openModal(productNames, totalPrice);
            toggleCart();
        }

        function addFullRitual() {
            const ritualProducts = [
                { name: 'Le Savon de Face Artisanal', price: 180, image: 'image555.png' },
                { name: 'The Silk Face Mask', price: 320, image: 'image444.png' },
                { name: 'Huile d\'Argan', price: 60, image: 'image88.png' }
            ];

            ritualProducts.forEach(product => {
                const existing = cart.find(item => item.name === product.name);
                if (existing) {
                    existing.quantity++;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
            });

            updateCartUI();
            showToast("Le Rituel Complet a été ajouté");

            // Pulse the cart icon
            const cartBtn = document.getElementById('cart-btn-nav');
            if (cartBtn) {
                cartBtn.classList.add('cart-pulse');
                setTimeout(() => cartBtn.classList.remove('cart-pulse'), 400);
            }

            // Open cart
            const drawer = document.getElementById('cart-drawer');
            if (drawer && !drawer.classList.contains('active')) {
                toggleCart();
            }
        }

        // Product Standout Logic
        function standoutProduct(imgEl) {
            const overlay = document.getElementById('product-standout-overlay');
            const content = document.getElementById('standout-content');
            const card = imgEl.closest('.product-card');

            // Capture details from the card
            const name = card.querySelector('h3').innerText;
            const price = card.querySelector('span').innerText;
            const desc = card.querySelectorAll('p')[1].innerHTML;
            const promise = card.querySelectorAll('p')[2].innerHTML;
            const imgSrc = imgEl.getAttribute('src');

            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center bg-base p-12 border border-gold/20 shadow-2xl">
                    <div class="aspect-[3/4] overflow-hidden bg-accent border border-white/5">
                        <img src="${imgSrc}" class="w-full h-full object-cover">
                    </div>
                    <div>
                        <p class="gold-text text-[10px] uppercase tracking-[4px] mb-6 font-bold">Détails du Produit</p>
                        <h3 class="serif text-4xl mb-4 italic text-primary">${name}</h3>
                        <p class="serif text-2xl gold-text mb-8">${price}</p>
                        
                        <div class="space-y-8 mb-12">
                            <div class="pl-4 border-l border-gold/20">
                                <p class="text-secondary text-sm leading-relaxed">${desc}</p>
                            </div>
                            <div class="pl-4 border-l border-gold/20">
                                <p class="text-primary italic text-sm leading-relaxed">${promise}</p>
                            </div>
                        </div>
                        
                        
                        <div class="flex flex-col gap-4">
                            <button onclick="openModal('${name.replace(/'/g, "\\'")}', ${parseInt(price)}); closeStandout();" 
                                class="btn-luxury w-full bg-primary text-base hover:bg-gold transition-all duration-500">Acheter Maintenant</button>
                            <button onclick="addToCart('${name.replace(/'/g, "\\'")}', ${parseInt(price)}, '${imgSrc}', event); closeStandout();" 
                                class="btn-luxury-outline w-full">Ajouter au Panier</button>
                        </div>
                    </div>
                </div>
            `;

            overlay.classList.remove('hidden');
            document.body.classList.add('blurred'); // Will trigger CSS blur
        }


        function closeStandout() {
            const overlay = document.getElementById('product-standout-overlay');
            overlay.classList.add('hidden');
            document.body.classList.remove('blurred');
        }

        // Initialize UI
        updateCartUI();

        hamburger.addEventListener('click', toggleMenu);
        // Modal Logic
        function openModal(productName, price) {
            const modal = document.getElementById('orderModal');
            document.getElementById('productName').value = productName;
            document.getElementById('displayProductName').innerText = productName;
            document.getElementById('displayProductPrice').innerText = price + " DH";
            modal.classList.remove('hidden');
        }

        function closeModal() {
            const modal = document.getElementById('orderModal');
            modal.classList.add('hidden');
        }

        // Review Modal Logic
        function openReviewModal() {
            document.getElementById('reviewModal').classList.remove('hidden');
        }

        function closeReviewModal() {
            document.getElementById('reviewModal').classList.add('hidden');
        }

        // Star Rating Logic
        const stars = document.querySelectorAll('.star');
        stars.forEach(star => {
            star.addEventListener('click', () => {
                const rating = star.dataset.rating;
                document.getElementById('reviewRating').value = rating;

                stars.forEach(s => {
                    if (parseInt(s.dataset.rating) <= parseInt(rating)) {
                        s.classList.add('text-gold');
                        s.classList.remove('text-neutral-700');
                    } else {
                        s.classList.remove('text-gold');
                        s.classList.add('text-neutral-700');
                    }
                });
            });
        });

        function submitReview(e) {
            e.preventDefault();

            // In a real app, this would send data to a server
            // Here we just simulate success
            const name = document.getElementById('reviewName').value;

            const form = document.getElementById('reviewForm');
            const originalContent = form.innerHTML;

            form.innerHTML = `
                <div class="text-center py-12 flex flex-col items-center gap-6 fade-in">
                    <div class="text-gold text-5xl">✓</div>
                    <div class="serif text-2xl italic text-primary">Merci pour votre lumière, ${name}.</div>
                    <p class="text-neutral-500 text-xs uppercase tracking-[3px]">Votre avis est en cours de modération.</p>
                </div>
            `;

            setTimeout(() => {
                closeReviewModal();
                setTimeout(() => {
                    form.innerHTML = originalContent;
                    // Re-bind star listeners if needed, but since we're closing it's fine for now
                }, 500);
            }, 3000);
        }

        function submitOrder(e) {
            e.preventDefault();

            const productName = document.getElementById('productName').value;
            const fullName = document.getElementById('fullName').value;
            const phone = document.getElementById('phone').value;
            const city = document.getElementById('city').value;
            const address = document.getElementById('address').value;
            const quantity = document.getElementById('quantity').value;

            // Format WhatsApp Message
            const message = `Bonjour, je souhaite commander :%0A` +
                `Produit: ${productName}%0A` +
                `Quantité: ${quantity}%0A` +
                `Prix Total: ${document.getElementById('displayProductPrice').innerText.replace(' DH', '') * quantity} DH%0A%0A` +
                `Mes informations :%0A` +
                `Nom: ${fullName}%0A` +
                `Téléphone: ${phone}%0A` +
                `Ville: ${city}%0A` +
                `Adresse: ${address}%0A%0A` +
                `*Mode de Paiement : Paiement à la Livraison*`;

            const whatsappUrl = `https://wa.me/212605764173?text=${message}`;

            window.open(whatsappUrl, '_blank');
            closeModal();
        }

        // Drag and Drop Logic with Local Storage Persistence
        document.addEventListener('DOMContentLoaded', () => {
            const grid = document.getElementById('product-grid');
            let draggables = document.querySelectorAll('.product-card');

            // Load saved order
            const savedOrder = JSON.parse(localStorage.getItem('idylProductOrder'));
            if (savedOrder) {
                const currentCards = Array.from(draggables);
                // Clear grid
                grid.innerHTML = '';
                // Append in saved order
                savedOrder.forEach(id => {
                    const card = currentCards.find(c => c.dataset.id === id);
                    if (card) grid.appendChild(card);
                });
                // Append any new products not in saved order
                currentCards.filter(c => !savedOrder.includes(c.dataset.id)).forEach(c => grid.appendChild(c));
                // Re-select draggables after reordering
                draggables = document.querySelectorAll('.product-card');
            }

            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', () => {
                    draggable.classList.add('dragging');
                    draggable.style.opacity = '0.5';
                });

                draggable.addEventListener('dragend', () => {
                    draggable.classList.remove('dragging');
                    draggable.style.opacity = '1';
                    saveOrder();
                });
            });

            grid.addEventListener('dragover', e => {
                e.preventDefault();
                const afterElement = getDragAfterElement(grid, e.clientY, e.clientX);
                const draggable = document.querySelector('.dragging');
                if (afterElement == null) {
                    grid.appendChild(draggable);
                } else {
                    grid.insertBefore(draggable, afterElement);
                }
            });

            function getDragAfterElement(container, y, x) {
                const draggableElements = [...container.querySelectorAll('.product-card:not(.dragging)')];

                return draggableElements.reduce((closest, child) => {
                    const box = child.getBoundingClientRect();
                    const offsetX = x - (box.left + box.width / 2);
                    const offsetY = y - (box.top + box.height / 2);
                    const dist = Math.hypot(offsetX, offsetY);

                    if (closest === null || dist < closest.dist) {
                        return { offset: dist, element: child, dist: dist };
                    } else {
                        return closest;
                    }
                }, null).element;
            }

            function saveOrder() {
                const currentOrder = [...document.querySelectorAll('.product-card')].map(c => c.dataset.id);
                localStorage.setItem('idylProductOrder', JSON.stringify(currentOrder));
            }
        });

        // 3D Tilt Effect for Heritage Section
        const tiltContainer = document.getElementById('tilt-container');
        const tiltElement = document.getElementById('tilt-element');

        if (tiltContainer && tiltElement) {
            tiltContainer.addEventListener('mousemove', (e) => {
                const rect = tiltContainer.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                // Calculate percentage from center
                const xPct = (x / rect.width) - 0.5;
                const yPct = (y / rect.height) - 0.5;

                // Max rotation degrees
                const rotation = 20;

                // RotateY is based on X movement, RotateX is based on Y movement (inverted)
                tiltElement.style.transform = `rotateY(${xPct * rotation}deg) rotateX(${yPct * -rotation}deg) scale(1.05)`;
            });

            tiltContainer.addEventListener('mouseleave', () => {
                tiltElement.style.transform = `rotateY(0deg) rotateX(0deg) scale(1)`;
            });
        }

        // Apply 3D Tilt to Concierge section as well
        const conciergeTiltContainer = document.getElementById('concierge-tilt-container');
        const conciergeTiltElement = document.getElementById('concierge-tilt-element');

        if (conciergeTiltContainer && conciergeTiltElement) {
            conciergeTiltContainer.addEventListener('mousemove', (e) => {
                const rect = conciergeTiltContainer.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const xPct = (x / rect.width) - 0.5;
                const yPct = (y / rect.height) - 0.5;
                const rotation = 15;
                conciergeTiltElement.style.transform = `rotateY(${xPct * rotation}deg) rotateX(${yPct * -rotation}deg) scale(1.02)`;
            });

            conciergeTiltContainer.addEventListener('mouseleave', () => {
                conciergeTiltElement.style.transform = `rotateY(0deg) rotateX(0deg) scale(1)`;
            });
        }

        // Particle System for Concierge Section
        const canvas = document.getElementById('particle-canvas');
        if (canvas) {
            const ctx = canvas.getContext('2d');
            let particles = [];

            function resize() {
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;
            }
            window.addEventListener('resize', resize);
            resize();

            class Particle {
                constructor() {
                    this.init();
                }
                init() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 2 + 0.5;
                    this.speedX = Math.random() * 0.5 - 0.25;
                    this.speedY = Math.random() * 0.5 - 0.25;
                    this.opacity = Math.random() * 0.5 + 0.2;
                }
                update() {
                    this.x += this.speedX;
                    this.y += this.speedY;
                    if (this.x < 0 || this.x > canvas.width) this.init();
                    if (this.y < 0 || this.y > canvas.height) this.init();
                }
                draw() {
                    ctx.fillStyle = `rgba(197, 160, 89, ${this.opacity})`;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                }
            }

            for (let i = 0; i < 100; i++) {
                particles.push(new Particle());
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => {
                    p.update();
                    p.draw();
                });
                requestAnimationFrame(animate);
            }
            animate();
        }

        // Global Heritage Particles
        const hCanvas = document.getElementById('heritage-particle-canvas');
        if (hCanvas) {
            const hCtx = hCanvas.getContext('2d');
            let hParticles = [];

            function hResize() {
                hCanvas.width = hCanvas.offsetWidth;
                hCanvas.height = hCanvas.offsetHeight;
            }
            window.addEventListener('resize', hResize);
            hResize();

            class HeritageParticle {
                constructor() {
                    this.init();
                }
                init() {
                    this.x = Math.random() * hCanvas.width;
                    this.y = Math.random() * hCanvas.height;
                    this.size = Math.random() * 3 + 0.5;
                    this.speedX = Math.random() * 0.8 - 0.4;
                    this.speedY = Math.random() * 0.8 - 0.4;
                    this.opacity = Math.random() * 0.6 + 0.1;
                    this.life = Math.random() * 100 + 100;
                }
                update() {
                    this.x += this.speedX;
                    this.y += this.speedY;
                    this.life--;
                    if (this.life <= 0 || this.x < 0 || this.x > hCanvas.width || this.y < 0 || this.y > hCanvas.height) {
                        this.init();
                    }
                }
                draw() {
                    hCtx.fillStyle = `rgba(197, 160, 89, ${this.opacity})`;
                    hCtx.shadowBlur = 10;
                    hCtx.shadowColor = '#c5a059';
                    hCtx.beginPath();
                    hCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    hCtx.fill();
                    hCtx.shadowBlur = 0;
                }
            }

            for (let i = 0; i < 60; i++) {
                hParticles.push(new HeritageParticle());
            }

            function hAnimate() {
                hCtx.clearRect(0, 0, hCanvas.width, hCanvas.height);
                hParticles.forEach(p => {
                    p.update();
                    p.draw();
                });
                requestAnimationFrame(hAnimate);
            }
            hAnimate();
        }

        // Enhanced Heritage Tilt with Glow
        const hTiltContainer = document.getElementById('tilt-container');
        const hTiltElement = document.getElementById('tilt-element');
        const hGlow = document.getElementById('heritage-glow');

        if (hTiltContainer && hTiltElement) {
            hTiltContainer.addEventListener('mousemove', (e) => {
                const rect = hTiltContainer.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const xPct = (x / rect.width) - 0.5;
                const yPct = (y / rect.height) - 0.5;
                const rotation = 25;

                hTiltElement.style.transform = `rotateY(${xPct * rotation}deg) rotateX(${yPct * -rotation}deg) scale(1.05)`;

                if (hGlow) {
                    hGlow.style.opacity = '1';
                    hGlow.style.left = `${x - 100}px`;
                    hGlow.style.top = `${y - 100}px`;
                }
            });

            hTiltContainer.addEventListener('mouseleave', () => {
                hTiltElement.style.transform = `rotateY(0deg) rotateX(0deg) scale(1)`;
                if (hGlow) hGlow.style.opacity = '0';
            });
        }
    </script>

    <style>
        @keyframes scrollLine {
            0% {
                transform: translateY(-100%);
            }

            50% {
                transform: translateY(0);
            }

            100% {
                transform: translateY(100%);
            }
        }
    </style>
</body>

</html>